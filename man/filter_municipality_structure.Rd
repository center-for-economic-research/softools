% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_municipality_structure.R
\name{filter_municipality_structure}
\alias{filter_municipality_structure}
\title{Filter Municipality-Year Combinations by Validity}
\usage{
filter_municipality_structure(
  data,
  municipality_structure,
  code_col = "code",
  year_col = "year"
)
}
\arguments{
\item{data}{A data frame with municipality observations per year. Must contain a column for municipality ID (Four numbers in character fromat) and the year of observervation (numeric or integer). The function assumes that the observation is recorded at the end of the calendar year.}

\item{municipality_structure}{Optional. A data frame with columns: `code`, `valid_from`, and `valid_to`. If not supplied, the function will call `get_municipality_structure()` to retrieve the structure for the period covering the years in `data`.}

\item{code_col}{Name of the column in `data` containing municipality IDs (character). Default: "code".}

\item{year_col}{Name of the column in `data` containing years (numeric/integer). Default: "year".}
}
\value{
A filtered data frame containing only valid municipality-year combinations.
}
\description{
Removes municipality-year combinations that are not valid according to the official SSB municipality structure.
The function checks if the municipality is valid for the entire year of observation, i.e.,
the municipality's validity period must cover the full calendar year for a row to be retained.
}
\details{
This function checks each municipality code against the validity period defined in the `municipality_structure` data frame. For a municipality-year combination to be retained, the municipality must be valid for the entire year (from January 1st to December 31st of the given year). Also drops municipality codes that are not present in the `municipality_structure`.
}
\examples{
\dontrun{
# Example data frame with municipality codes and years
# Trondheim (1601) and Moss (3002) were not valid in 2018 and 2022, respectively.
# Oslo (0301) and Halden (3001) are valid in 2020 and 2021.
data <- data.frame(
  code = c("0301", "1601", "3001", "3002"),
  year = c(2020, 2018, 2021, 2022)
)
# Filter out invalid municipality codes based on structure
filtered_data <- filter_municipality_structure(data)
# Only the valid municipality-year combinations will remain:
#   code year
# 1 0301 2020
# 2 3001 2021

# Using a custom municipality structure
# municipality_structure <- get_municipality_structure(2018, 2022)
# filtered_data <- filter_municipality_structure(data, municipality_structure)
}

}
